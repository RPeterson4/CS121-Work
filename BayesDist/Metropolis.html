<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title></title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>



<!-- MathJax scripts -->
<script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



</head>

<body>
<p>In hierarchical Bayesian modeling, the high number of priors often makes deriving the posterior density difficult. A possible solution is a Markov chain Monte Carlo (MCMC) simulation. For \( Y \), a set of complicated prior parameters, and \( X=x \), an observed set of data, MCMC involves taking a chain of samples (\( y_1,y_2,...,y_n \)) from a distribution \( \neq f(y|x) \), whereby the samples are dependent upon one another (i.e., \( y_{i+1} \) depends on \( y_i \)). A couple criteria allow this chain to approximate the posterior \( f(y|x) \), also known as the target density:</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&bull; the chain can only visit a limited range of \( y \) values</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&bull; The time spent at each \( y \) value must be proportional to \( f(y|x) \)</p>

<p>The chain of \( y \) values then takes on the shape of a random sample from \( f(y|x) \). Once this chain is large enough, we can approximate the posterior density of \( f(y|x) \).</p>

<p>Consider the following example:</p>

<p>Ross presides over continuous farmland. Let \( Y>0 \) be the distance from Ross&#39;s barn and \( f(y) \) be the plant growth density at acre \( y \) such that:</p>

<p><center> \( Y \sim Gamma (7.5, .15) \) </p>

<p>\( f(y|7.5,.15) \propto y^{6.5}e^{-.15y} \) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>for</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \( y > 0 \)</p>

<p></center></p>

<p>Ross intends his time spent working on each acre to be proportional to its relative plant density. How can a Metropolis Algorithm simulate Ross&#39;s work schedule?</p>

<p>Let \( y \) start at acre \( 50 \):</p>

<p>For each day, we propose a new acre to Ross from some symmetric distribution, \( N(\mu,\sigma) \):</p>

<p><i>set.seed(2000)</i></p>

<p><i> y1 = 50 </i></p>

<p><i>f1 = rnorm(1,mean=y1,sd=10)</i></p>

<p>Ross then compares the plant growth of the new acre to that of the acre he is currently working on:</p>

<p><i>paccept = min(1,dgamma(f1,s=7.5,r=.15)/dgamma(y1,s=7.5,r=.15))</i></p>

<p>If the plant growth of the new acre &gt; old acre, Ross will always switch to the new acre. This is reflected in the command <i>min (1&hellip;)</i>. If the plant growth of the new acre &gt; current acre, <i>min(1&hellip;)</i> will always select 1, a probability of 100%.</p>

<p>If the plant growth of the new acre &lt; current acre, Ross will switch based on the probability generated from \( \frac{plant \ growth \ of \ new \ acre}{plant \ growth \ of \ current \ acre} \): simulated by: <i> dgamma(f1,s=7.5,r=.15)/dgamma(y1,s=7.5,r=.15) </i>. </p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&bull; Note that Ross&#39;s decision to work on the new acre depends on the plant growth of his current acre</p>

<p>Ross&#39;s potential acceptance of the new acre can be simulated as:</p>

<p><i> p2 = sample(c(f1,y1),size=1,prob(paccept,1-paccept))</i></p>

<p>As the days pass, we propose new acres to Ross who then compares them to his current acre, making for a cyclical algorithm that after enough samples approximates \( P \sim Gamma (7.5, .15) \). </p>

<p>Here, the number of samples has been set from 100 to 10,000. \( \sigma \) alters the standard deviation of the acres proposed to Ross.</p>

</body>

</html>

